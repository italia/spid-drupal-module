{{ attach_library('spid/spid.sp_access_button') }}

<a href="#" class="italia-it-button italia-it-button-size-{{ size|slice(0, 1) }} button-spid" spid-idp-button="#spid-idp-button-{{ size }}-get" aria-haspopup="true" aria-expanded="false">
    <span class="italia-it-button-icon"><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-ico-circle-bb.svg" onerror="this.src='img/spid-ico-circle-bb.png'; this.onerror=null;" alt="" /></span>
    <span class="italia-it-button-text">Entra con SPID</span>
</a>
<div id="spid-idp-button-{{ size }}-get" class="spid-idp-button spid-idp-button-tip spid-idp-button-relative">
    <ul id="spid-idp-list-{{ size }}-root-get" class="spid-idp-button-menu" aria-labelledby="spid-idp">
        <li class="spid-idp-button-link" data-idp="arubaid">
            <a href="/spid/login/idp_5"><span class="spid-sr-only">Aruba ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-arubaid.svg" onerror="this.src='img/spid-idp-arubaid.png'; this.onerror=null;" alt="Aruba ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="infocertid">
            <a href="/spid/login/idp_1"><span class="spid-sr-only">Infocert ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-infocertid.svg" onerror="this.src='img/spid-idp-infocertid.png'; this.onerror=null;" alt="Infocert ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="intesaid">
            <a href="/spid/login/idp_8"><span class="spid-sr-only">Intesa ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-intesaid.svg" onerror="this.src='img/spid-idp-intesaid.png'; this.onerror=null;" alt="Intesa ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="lepidaid">
            <a href="/spid/login/idp_9"><span class="spid-sr-only">Lepida ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-lepidaid.svg" onerror="this.src='img/spid-idp-lepidaid.png'; this.onerror=null;" alt="Lepida ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="namirialid">
            <a href="/spid/login/idp_6"><span class="spid-sr-only">Namirial ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-namirialid.svg" onerror="this.src='img/spid-idp-namirialid.png'; this.onerror=null;" alt="Namirial ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="posteid">
            <a href="/spid/login/idp_2"><span class="spid-sr-only">Poste ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-posteid.svg" onerror="this.src='img/spid-idp-posteid.png'; this.onerror=null;" alt="Poste ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="sielteid">
            <a href="/spid/login/idp_4"><span class="spid-sr-only">Sielte ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-sielteid.svg" onerror="this.src='img/spid-idp-sielteid.png'; this.onerror=null;" alt="Sielte ID" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="spiditalia">
            <a href="/spid/login/idp_7"><span class="spid-sr-only">SPIDItalia Register.it</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-spiditalia.svg" onerror="this.src='img/spid-idp-spiditalia.png'; this.onerror=null;" alt="SpidItalia" /></a>
        </li>
        <li class="spid-idp-button-link" data-idp="timid">
            <a href="/spid/login/idp_3"><span class="spid-sr-only">Tim ID</span><img src="/{{ img_folder }}/assets/spid-sp-access-button/img/spid-idp-timid.svg" onerror="this.src='img/spid-idp-timid.png'; this.onerror=null;" alt="Tim ID" /></a>
        </li>
        {% if is_testenv_enabled %}
        <li class="spid-idp-button-link" data-idp="test">
            <a href="/spid/login/test"><span class="spid-sr-only">Testenv</span><img src="/{{ img_folder }}/assets/img/spid-ico-circle-bb.svg" onerror="this.src='img/spid-ico-circle-bb.png'; this.onerror=null;" alt="Testenv" /></a>
        </li>
        {% endif %}
        <li class="spid-idp-support-link">
            <a href="https://www.spid.gov.it">Maggiori informazioni</a>
        </li>
        <li class="spid-idp-support-link">
            <a href="https://www.spid.gov.it/richiedi-spid">Non hai SPID?</a>
        </li>
        <li class="spid-idp-support-link">
            <a href="https://www.spid.gov.it/serve-aiuto">Serve aiuto?</a>
        </li>
    </ul>
</div>

<script>
    (function ($) {
        'use strict';

        Drupal.behaviors.spid_sp_access_button = {
            attach: function (context) {
                var rootList = $("#spid-idp-list-{{ size }}-root-get");
                var idpList = rootList.children(".spid-idp-button-link");
                var lnkList = rootList.children(".spid-idp-support-link");
                while (idpList.length) {
                    rootList.append(idpList.splice(Math.floor(Math.random() * idpList.length), 1)[0]);
                }
                rootList.append(lnkList);
            }
        };

    })(jQuery);
</script>
