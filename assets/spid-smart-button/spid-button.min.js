var SPID=function(){"use strict";var t=function(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,document.head.appendChild(e)},e=function(t,e){return['<img aria-hidden="true"','src="',SPID.assetsBaseUrl,t,'.svg"','alt="',e,'" style="float:left" />'].join("")},i=function(t,e){return['<input type="hidden" name="',t,'" value="',e,'" />'].join("")},o=function(t,e){this.config=t,this._providers=e};o.prototype.changeLanguage=function(t){var e=this;e.config.lang=t,e._render()},o.prototype._showElement=function(t){t.removeAttribute("hidden")},o.prototype._hideElement=function(t){var e=document.createAttribute("hidden");t.setAttributeNode(e)},o.prototype._giveFocusTo=function(t){var e=setInterval(function(){t.focus()},100);t.addEventListener("focus",function(){clearInterval(e)})},o.prototype._handleEscKeyEvent=function(t){var e=this;27===t.keyCode&&e._hideProvidersPanel()};var n;o.prototype._showProvidersPanel=function(){var t=this;t._btn.classList.add("spid-button-transition"),t._showElement(t._wrapper),t._giveFocusTo(t._wrapper.querySelector(".spid-button-panel-select")),t._wrapper.querySelector(".spid-button-logo").classList.add("spid-button-fade-in-left"),t._wrapper.querySelector(".spid-button-close-button").classList.add("spid-button-fade-in-left"),t._wrapper.querySelector(".spid-button-panel-select").classList.add("spid-button-panel-anim"),t._btn.querySelector(".spid-button-icon").classList.add("spid-button-icon-animation"),t._btn.querySelector(".spid-button-icon").classList.add("in");var e=t._wrapper.querySelectorAll(".spid-button-idp"),i=1.1;e.forEach(function(t){t.classList.add("spid-button-idp-fade-in"),t.setAttribute("style","animation-delay: "+i+"s"),i+=.1}),setTimeout(function(){t._btn.classList.remove("spid-button-transition"),t._wrapper.querySelector(".spid-button-logo").classList.remove("spid-button-fade-in-left"),t._wrapper.querySelector(".spid-button-close-button").classList.remove("spid-button-fade-in-left"),t._wrapper.querySelector(".spid-button-panel-select").classList.remove("spid-button-panel-anim"),e.forEach(function(t){t.classList.remove("spid-button-idp-fade-in"),t.removeAttribute("style")})},2e3),n=function(e){t._handleEscKeyEvent(e)},document.addEventListener("keyup",n)},o.prototype._hideProvidersPanel=function(){var t=this;t._hideElement(t._wrapper),t._btn.querySelector(".spid-button-icon").classList.remove("in"),t._wrapper.querySelector(".spid-button-little-man-icon").classList.add("spid-button-logo-animation-out"),t._wrapper.querySelector(".spid-button-panel-select").classList.add("spid-button-panel-anim"),t._btn.classList.remove("spid-button-transition"),t._btn.classList.add("spid-button-reverse-enter-transition"),setTimeout(function(){t._btn.classList.remove("spid-button-reverse-enter-transition"),t._wrapper.querySelector(".spid-button-little-man-icon").classList.remove("spid-button-logo-animation-out")},2e3),document.removeEventListener("keyup",n),n=null},o.prototype._render=function(){var e=this,i=document.querySelector(e.config.selector);i?(i.setAttribute("aria-live","polite"),i.innerHTML=e._renderButton(),e._btn=i.querySelector(".spid-button"),e._btn.addEventListener("click",function(t){e._showProvidersPanel()}),e._btn.querySelector(".spid-enter-container")||(t(SPID.stylesheetUrl),e._wrapper=document.createElement("section"),e._wrapper.classList.add("spid-enter-container"),e._hideElement(e._wrapper),i.insertBefore(e._wrapper,i.firstChild),e._wrapper.innerHTML='<div class="spid-enter"></div>'),e._wrapper.querySelector(".spid-enter").innerHTML=e._renderProvidersChoiceModal(),e._wrapper.querySelector(".spid-button-panel-close-button").addEventListener("click",function(t){e._hideProvidersPanel()}),e._wrapper.querySelector(".spid-cancel-access-button").addEventListener("click",function(t){e._hideProvidersPanel()})):console.warn("Nessun placeholder HTML trovato nella pagina per i pulsanti SPID.")},o.prototype._getI18n=function(t,e){var i=this.config.lang,o=SPID.i18n[i]&&SPID.i18n[i][t],n=/\{\d}/;return void 0!==e&&(o=o.replace(n,e)),o||console.error("La chiave richiesta non è disponibile nella lingua selezionata:",locale,t),o||t},o.prototype._renderProvidersChoiceModal=function(){var t=this,i="";return t._providers.forEach(function(e){i+=t._renderProviderButton(e)}),['<section class="spid-button-panel spid-button-panel-select" aria-label="',t._getI18n("scegli_provider_SPID"),'" tabindex="0">','<header class="spid-button-header">','<div class="spid-button-panel-back">','<div class="spid-button-logo spid-button-fade-out-left">',e("img/spid-logo",t._getI18n("alt_logo_SPID")),"</div>",'<div class="spid-button-close-button spid-button-fade-out-right">','<button tabindex="0" class="spid-button-panel-close-button spid-button-navigable" aria-label="',t._getI18n("naviga_indietro"),'">',e("img/close",t._getI18n("naviga_indietro")),"</button>","</div>","</div>","</header>",'<div class="spid-button-panel-content">','<img class="spid-button-little-man-icon" src="',SPID.assetsBaseUrl,"img/spid-logo-animation-black.svg",'" alt="',t._getI18n("entra_con_SPID"),'"></img>','<div class="spid-button-panel-content-center">','<h1 class="spid-enter-title-page spid-button-fade-in-bottom spid-button-fade-out-bottom">',t._getI18n("scegli_provider_SPID"),"</h1>",'<div class="spid-idp-list">',i,"</div>",'<div class="spid-non-hai-spid">',t._getI18n("non_hai_SPID"),' <a href="https://www.spid.gov.it/richiedi-spid" target="_blank">',t._getI18n("scopri_di_piu"),"</a>","</div>","</div>",'<div class="spid-foot-btn">','<button class="spid-cancel-access-button">',t._getI18n("annulla_accesso"),"</button>","</div>","</div>","</section>"].join("")},o.prototype._renderProviderButton=function(t){var e=this,o=!1;e.config.extraProviders.forEach(function(e){t.entityID==e.entityID&&(o=!0)});var n=e.config.supported.indexOf(t.entityID)>-1&&t.protocols.indexOf(e.config.protocol)>-1&&(0==e.config.extraProviders.length||o)&&!1!==t.active,s=n?e._getI18n("accedi_con_idp",t.entityName):e._getI18n("idp_disabled"),r=t.entityID in e.config.mapping?e.config.mapping[t.entityID]:t.entityID,a=e.config.url.replace("{{idp}}",encodeURIComponent(r)),d=t.logo?['<img src="',SPID.assetsBaseUrl,"img/idp-logos/",t.logo,'" alt="',t.entityName,'">'].join(""):["<span>",t.entityName,"</span>"].join("");if("POST"===e.config.method){var l=i(e.config.fieldName,r);for(var p in e.config.extraFields)l+=i(p,e.config.extraFields[p]);return['<span class="spid-button-idp">','<form action="',a,'" method="POST">','<button type="submit"','class="spid-button-idp-button"','title="',s,'"',n?"":"disabled",">",d,"</button>",l,"</form>","</span>"].join("")}if("GET"===e.config.method)return['<span class="spid-button-idp">','<a title="',s,'" href="',a,'"',n?"":"disabled",">",d,"</a>","</span>"].join("")},o.prototype._renderButton=function(){var t=this,e=t.config.fluid?" spid-button-fluid ":"",i="negative"==t.config.colorScheme?"img/spid-ico-circle-lb.svg":"img/spid-ico-circle-bb.svg";return['<button class="spid-button spid-button-',t.config.colorScheme," spid-button-",t.config.cornerStyle," spid-button-size-",t.config.size,e,'" hidden>','<span aria-hidden="true" class="spid-button-icon">','<img src="',SPID.assetsBaseUrl,i,'" alt="',t._getI18n("entra_con_SPID"),'" />',"</span>",'<span class="spid-button-text">',t._getI18n("entra_con_SPID"),"</span>","</button>"].join("")};var s={lang:"it",method:"GET",fieldName:"idp",extraFields:{},selector:"#spid-button",mapping:{},extraProviders:[],protocol:"SAML",size:"medium",colorScheme:"positive",fluid:!1,cornerStyle:"rounded"},r=["small","medium","large"],a=["positive","negative"],d=["rounded","sharp"],l=[!0,!1];return{init:function(t){var e;if("object"!=typeof t||null===t)e="Non è stata fornita la configurazione";else{t=JSON.parse(JSON.stringify(t));for(var i in s)i in t||(t[i]=s[i]);t.url?"GET"==t.method&&-1===t.url.indexOf("{{idp}}")?e="L'url non contiene il placeholder {{idp}}":-1===r.indexOf(t.size)?e="Le dimensioni supportate sono "+r+"; valore non valido:"+t.size:-1===a.indexOf(t.colorScheme)?e="I colori supportati sono "+a+"; valore non valido:"+t.colorScheme:-1===d.indexOf(t.cornerStyle)?e="Il valori supportati per il parametro cornerStyle sono "+d+"; valore non valido:"+t.cornerStyle:-1===l.indexOf(t.fluid)&&(e="I valori supportati per il parametro fluid sono "+l+"; valore non valido:"+t.fluid):e="Non è stato fornito l'url obbligatorio in configurazione"}{if(!e){var n=JSON.parse(JSON.stringify(SPID.providers));t.extraProviders.forEach(function(e){"protocols"in e||(e.protocols=["SAML"]),n.push(e),t.supported.push(e.entityID)});var p=new o(t,n);return p._render(),p}console.error(e)}}}}();SPID.i18n={it:{naviga_indietro:"Torna indietro",alt_logo_SPID:"Logo SPID",scegli_provider_SPID:"Scegli il tuo provider SPID",annulla_accesso:"Annulla",non_hai_SPID:"Non hai SPID?",cosa_SPID:"Cos'è SPID?",entra_con_SPID:"Entra con SPID",scopri_di_piu:"Scopri di più.",accedi_con_idp:"Accedi a SPID con {0}",idp_disabled:"Provider non attivo"},en:{naviga_indietro:"Go back",alt_logo_SPID:"SPID logo",scegli_provider_SPID:"Choose your SPID provider",annulla_accesso:"Cancel",non_hai_SPID:"Don't have SPID?",cosa_SPID:"What is SPID?",entra_con_SPID:"Sign in with SPID",scopri_di_piu:"Learn more.",accedi_con_idp:"Access to SPID with {0}",idp_disabled:"Provider not enabled"},de:{naviga_indietro:"Gehen Sie zurück",alt_logo_SPID:"SPID Logo",scegli_provider_SPID:"Wähle Ihren SPIDProvider",annulla_accesso:"Zurücknehmen",non_hai_SPID:"Haben Sie nicht SPID?",cosa_SPID:"Was ist SPID?",entra_con_SPID:"Loggen Sie mit SPID",scopri_di_piu:"Finde mehr heraus.",accedi_con_idp:"Zugriff auf SPID mit {0}",idp_disabled:"Provider nicht aktiviert"}},SPID.providers=[{protocols:["SAML"],entityName:"Aruba ID",logo:"spid-idp-arubaid.svg",entityID:"https://loginspid.aruba.it",active:!0},{protocols:["SAML"],entityName:"Infocert ",logo:"spid-idp-infocertid.svg",entityID:"https://identity.infocert.it",active:!0},{protocols:["SAML"],entityName:"Poste ID",logo:"spid-idp-posteid.svg",entityID:"https://posteid.poste.it",active:!0},{protocols:["SAML"],entityName:"Sielte",logo:"spid-idp-sielteid.svg",entityID:"https://identity.sieltecloud.it",active:!0},{protocols:["SAML"],entityName:"Tim ID",logo:"spid-idp-timid.svg",entityID:"https://login.id.tim.it/affwebservices/public/saml2sso",active:!0},{protocols:["SAML"],entityName:"Namirial ID",logo:"spid-idp-namirialid.svg",entityID:"https://idp.namirialtsp.com/idp",active:!0},{protocols:["SAML"],entityName:"SPIDItalia Register.it",logo:"spid-idp-spiditalia.svg",entityID:"https://spid.register.it",active:!0},{protocols:["SAML"],entityName:"Intesa ID",logo:"spid-idp-intesaid.svg",entityID:"https://spid.intesa.it",active:!0},{protocols:["SAML"],entityName:"Lepida ID",logo:"spid-idp-lepidaid.svg",entityID:"https://id.lepida.it/idp/shibboleth",active:!0}],SPID.assetsBaseUrl="https://italia.github.io/spid-smart-button/",SPID.stylesheetUrl="https://italia.github.io/spid-smart-button/spid-button.min.css";